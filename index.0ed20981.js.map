{"mappings":"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","sources":["src/v9-mvc-refined/guess.ts","node_modules/@swc/helpers/src/_define_property.mjs","src/v9-mvc-refined/index.ts","src/v9-mvc-refined/words-repository.ts","src/v9-mvc-refined/word-validator.ts","src/v9-mvc-refined/use-cases/get-word-guesses-use-case.ts","src/v9-mvc-refined/use-cases/get-random-word-to-guess-use-case.ts","src/v9-mvc-refined/view.ts","src/v9-mvc-refined/controller.ts"],"sourcesContent":["export enum Guess {\n  EMPTY = -2,\n  NOT_PRESENT = -1,\n  PRESENT_BUT_NOT_IN_CORRECT_POSITION = 0,\n  PRESENT_AND_IN_CORRECT_POSITION = 1,\n}\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n","import { GetWordGuessesUseCase } from './use-cases/get-word-guesses-use-case'\nimport { WordValidator } from './word-validator'\nimport { View } from './view'\nimport { Controller } from './controller'\nimport { GetRandomWordToGuessUseCase } from './use-cases/get-random-word-to-guess-use-case'\nimport { WordsRepository } from './words-repository'\n\nconst wordsRepository = new WordsRepository(window)\nconst wordValidator = new WordValidator()\nconst getWordGuessesUseCase = new GetWordGuessesUseCase(wordValidator)\nconst getRandomWordToGuessUseCase = new GetRandomWordToGuessUseCase(wordsRepository)\n\nconst view = new View()\nconst controller = new Controller(view, getWordGuessesUseCase, getRandomWordToGuessUseCase)\ncontroller.init()\n\nexport {}\n","type Word = string\n\nexport class WordsRepository {\n  constructor(private readonly global: typeof globalThis) {}\n\n  findAll(): Promise<Word[]> {\n    return this.global\n      .fetch(\n        'https://gist.githubusercontent.com/cesalberca/3d0e343842c7697e0f788178e59fb471/raw/22bfe35c910dd02db78fec87fa39ca25cc604816/data.json',\n      )\n      .then(x => x.json())\n  }\n}\n","import { Guess } from './guess'\n\nexport class WordValidator {\n  validate(wordToTry: string, wordToGuess: string): Guess[] {\n    if (wordToTry === wordToGuess) {\n      return Array.from<Guess>({ length: wordToGuess.length }).fill(Guess.PRESENT_AND_IN_CORRECT_POSITION)\n    }\n\n    return wordToTry.split('').map((letterToTry, indexLetterToGuess) => {\n      const letterToGuess = wordToGuess[indexLetterToGuess]\n      if (letterToTry === letterToGuess) {\n        return Guess.PRESENT_AND_IN_CORRECT_POSITION\n      }\n\n      if (wordToGuess.includes(letterToTry)) {\n        return Guess.PRESENT_BUT_NOT_IN_CORRECT_POSITION\n      }\n\n      return Guess.NOT_PRESENT\n    })\n  }\n}\n","import { WordValidator } from '../word-validator'\nimport { Guess } from '../guess'\n\nexport class GetWordGuessesUseCase {\n  constructor(private readonly wordValidator: WordValidator) {}\n\n  async execute(wordToTry: string, wordToGuess: string): Promise<Guess[]> {\n    return this.wordValidator.validate(wordToTry, wordToGuess)\n  }\n}\n","import { WordsRepository } from '../words-repository'\n\nexport class GetRandomWordToGuessUseCase {\n  constructor(private readonly wordsRepository: WordsRepository) {}\n\n  async execute(seed: number) {\n    const words = await this.wordsRepository.findAll()\n    const wordToGuess = words[Math.floor(seed * words.length)]\n    return wordToGuess\n  }\n}\n","import { Guess } from './guess'\n\nexport class View {\n  private boardElement = document.querySelector<HTMLDivElement>('#board')!\n  private form = document.querySelector<HTMLFormElement>('#form')!\n  private element = document.querySelector<HTMLInputElement>('#input')!\n\n  private boardLength: number\n  private maxRows = 6\n\n  init(maxRows: number, rowLength: number, tries: Guess[][], triedWords: string[]) {\n    this.maxRows = maxRows\n    this.boardLength = rowLength\n    this.printBoard(tries, triedWords)\n  }\n\n  printBoard(tries: Guess[][], triedWords: string[]) {\n    this.clearBoard()\n    for (let i = 0; i < this.maxRows; i++) {\n      this.printRow(tries[i], triedWords[i])\n    }\n  }\n\n  addEventListeners(onGuessWord: Function) {\n    this.form.addEventListener('submit', async (e: Event) => {\n      e.preventDefault()\n\n      if (!this.element.value) {\n        return\n      }\n\n      await onGuessWord(this.element.value)\n    })\n  }\n\n  showWonMessage() {\n    alert('You won! Try again!')\n  }\n\n  showLostMessage(wordToGuess: string) {\n    alert(`You lost! The word to guess was ${wordToGuess}. Try again!`)\n  }\n\n  clearInput() {\n    this.element.value = ''\n  }\n\n  private clearBoard() {\n    this.boardElement.innerHTML = ''\n  }\n\n  private printRow(guesses: Guess[], triedWord?: string) {\n    const wordDiv = document.createElement('div')\n    wordDiv.setAttribute('class', 'row')\n\n    for (let i = 0; i < this.boardLength; i++) {\n      this.printLetterCell(wordDiv, guesses[i], triedWord?.[i])\n      this.boardElement.appendChild(wordDiv)\n    }\n  }\n\n  private printLetterCell(element: HTMLDivElement, guess: Guess, triedLetter?: string) {\n    const div = document.createElement('div')\n    div.classList.add('cell')\n    if (triedLetter !== undefined) {\n      div.innerHTML = triedLetter\n    }\n\n    let className = ''\n    switch (guess) {\n      case Guess.NOT_PRESENT:\n        className = 'not-present'\n        break\n      case Guess.PRESENT_AND_IN_CORRECT_POSITION:\n        className = 'present-and-in-correct-position'\n        break\n      case Guess.PRESENT_BUT_NOT_IN_CORRECT_POSITION:\n        className = 'present-but-not-in-correct-position'\n        break\n      case Guess.EMPTY:\n        className = 'empty'\n        break\n    }\n\n    div.classList.add(className)\n\n    element.appendChild(div)\n  }\n}\n","import { View } from './view'\nimport { GetWordGuessesUseCase } from './use-cases/get-word-guesses-use-case'\nimport { GetRandomWordToGuessUseCase } from './use-cases/get-random-word-to-guess-use-case'\nimport { Guess } from './guess'\n\nexport class Controller {\n  private wordToGuess = ''\n  private tries: Guess[][] = []\n  private triedWords: string[] = []\n  private maximumNumberOfTries = 6\n\n  constructor(\n    private readonly view: View,\n    private readonly getWordGuessesUseCase: GetWordGuessesUseCase,\n    private readonly getRandomWordToGuessUseCase: GetRandomWordToGuessUseCase,\n  ) {}\n\n  init = async () => {\n    const seed = Math.random()\n    this.wordToGuess = await this.getRandomWordToGuessUseCase.execute(seed)\n    this.generateEmptyGuesses()\n    console.log(this.wordToGuess)\n    this.view.init(this.maximumNumberOfTries, this.wordToGuess.length, this.tries, this.triedWords)\n    this.view.addEventListeners(this.wordHandler)\n  }\n\n  wordHandler = async (wordToTry: string) => {\n    const result = await this.getWordGuessesUseCase.execute(wordToTry, this.wordToGuess)\n    this.tries[this.triedWords.length] = result\n    this.triedWords.push(wordToTry)\n\n    this.updateView()\n\n    if (this.isWordGuessed(result)) {\n      this.view.showWonMessage()\n      this.resetGame()\n      return\n    }\n\n    const isLastTry = this.triedWords.length === this.maximumNumberOfTries\n\n    if (isLastTry) {\n      this.view.showLostMessage(this.wordToGuess)\n      this.resetGame()\n    }\n\n    return result\n  }\n\n  private resetGame() {\n    this.tries = []\n    this.triedWords = []\n    this.init()\n  }\n\n  private updateView() {\n    this.view.printBoard(this.tries, this.triedWords)\n    this.view.clearInput()\n  }\n\n  private generateEmptyGuesses() {\n    for (let i = 0; i < this.maximumNumberOfTries; i++) {\n      const values: Guess[] = []\n      for (let j = 0; j < this.wordToGuess.length; j++) {\n        values.push(Guess.EMPTY)\n      }\n      this.tries.push(values)\n    }\n  }\n\n  private isWordGuessed(word: Guess[]) {\n    return word.every(x => x === Guess.PRESENT_AND_IN_CORRECT_POSITION)\n  }\n}\n"],"names":["$02d20f9ed87de6af$export$7a872ecb27ac8565","Guess","EMPTY","NOT_PRESENT","PRESENT_BUT_NOT_IN_CORRECT_POSITION","PRESENT_AND_IN_CORRECT_POSITION","$bb9a5d09fff8458d$export$2e2bcd8739ae039","obj","key","value","Object","defineProperty","enumerable","configurable","writable","wordsRepository","findAll","this","global","fetch","then","x","json","constructor","window","wordValidator","validate","wordToTry","wordToGuess","Array","from","length","fill","split","map","letterToTry","indexLetterToGuess","includes","getWordGuessesUseCase","async","getRandomWordToGuessUseCase","seed","words","Math","floor","view","init","maxRows","rowLength","tries","triedWords","boardLength","printBoard","clearBoard","i","printRow","addEventListeners","onGuessWord","form","addEventListener","e","preventDefault","element","showWonMessage","alert","showLostMessage","clearInput","boardElement","innerHTML","guesses","triedWord","wordDiv","document","createElement","setAttribute","printLetterCell","appendChild","guess","triedLetter","div","classList","add","undefined","className","querySelector","resetGame","updateView","generateEmptyGuesses","maximumNumberOfTries","values","j","push","isWordGuessed","word","every","random","execute","console","log","wordHandler","result"],"version":3,"file":"index.0ed20981.js.map"}